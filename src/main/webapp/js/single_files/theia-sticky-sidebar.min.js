!function(a){a.fn.theiaStickySidebar=function(g){var l,f,j,b,h,k;function c(d,e){return !0===d.initialized||!(a("body").width()<d.minWidth)&&(function(o,n){o.initialized=!0,0===a("#theia-sticky-sidebar-stylesheet-"+o.namespace).length&&a("head").append(a('<style id="theia-sticky-sidebar-stylesheet-'+o.namespace+'">.theiaStickySidebar:after {content: ""; display: table; clear: both;}</style>'));n.each(function(){var r={};if(r.sidebar=a(this),r.options=o||{},r.container=a(r.options.containerSelector),0==r.container.length&&(r.container=r.sidebar.parent()),r.sidebar.parents(":not(.theia-exception)").css("-webkit-transform","none"),r.sidebar.css({position:r.options.defaultPosition,overflow:"visible","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),r.stickySidebar=r.sidebar.find(".theiaStickySidebar"),0==r.stickySidebar.length){var q=/(?:text|application)\/(?:x-)?(?:javascript|ecmascript)/i;r.sidebar.find("script").filter(function(s,z){return 0===z.type.length||z.type.match(q)}).remove(),r.stickySidebar=a("<div>").addClass("theiaStickySidebar").append(r.sidebar.children()),r.sidebar.append(r.stickySidebar)}r.marginBottom=parseInt(r.sidebar.css("margin-bottom")),r.paddingTop=parseInt(r.sidebar.css("padding-top")),r.paddingBottom=parseInt(r.sidebar.css("padding-bottom"));var y,w,p,v=r.stickySidebar.offset().top,x=r.stickySidebar.outerHeight();function u(){r.fixedScrollTop=0,r.sidebar.css({"min-height":"1px"}),r.stickySidebar.css({position:"static",width:"",transform:"none"})}r.stickySidebar.css("padding-top",1),r.stickySidebar.css("padding-bottom",1),v-=r.stickySidebar.offset().top,x=r.stickySidebar.outerHeight()-x-v,0==v?(r.stickySidebar.css("padding-top",0),r.stickySidebarPaddingTop=0):r.stickySidebarPaddingTop=1,0==x?(r.stickySidebar.css("padding-bottom",0),r.stickySidebarPaddingBottom=0):r.stickySidebarPaddingBottom=1,r.previousScrollTop=null,r.fixedScrollTop=0,u(),r.onScroll=function(H){if(H.stickySidebar.is(":visible")){if(a("body").width()<H.options.minWidth){u()}else{if(H.options.disableOnResponsiveLayouts){var Q=H.sidebar.outerWidth("none"==H.sidebar.css("float"));if(Q+50>H.container.width()){return void u()}}var D,L,z=a(document).scrollTop(),K="static";if(z>=H.sidebar.offset().top+(H.paddingTop-H.options.additionalMarginTop)){var O,C=H.paddingTop+o.additionalMarginTop,N=H.paddingBottom+H.marginBottom+o.additionalMarginBottom,B=H.sidebar.offset().top,M=H.sidebar.offset().top+(D=H.container,L=D.height(),D.children().each(function(){L=Math.max(L,a(this).height())}),L),A=0+o.additionalMarginTop,I=H.stickySidebar.outerHeight()+C+N<a(window).height();O=I?A+H.stickySidebar.outerHeight():a(window).height()-H.marginBottom-H.paddingBottom-o.additionalMarginBottom;var G=B-z+H.paddingTop,E=M-z-H.paddingBottom-H.marginBottom,F=H.stickySidebar.offset().top-z,P=H.previousScrollTop-z;"fixed"==H.stickySidebar.css("position")&&"modern"==H.options.sidebarBehavior&&(F+=P),"stick-to-top"==H.options.sidebarBehavior&&(F=o.additionalMarginTop),"stick-to-bottom"==H.options.sidebarBehavior&&(F=O-H.stickySidebar.outerHeight()),F=0<P?Math.min(F,A):Math.max(F,O-H.stickySidebar.outerHeight()),F=Math.max(F,G),F=Math.min(F,E-H.stickySidebar.outerHeight());var J=H.container.height()==H.stickySidebar.outerHeight();K=(J||F!=A)&&(J||F!=O-H.stickySidebar.outerHeight())?z+F-H.sidebar.offset().top-H.paddingTop<=o.additionalMarginTop?"static":"absolute":"fixed"}if("fixed"==K){var T=a(document).scrollLeft();H.stickySidebar.css({position:"fixed",width:m(H.stickySidebar)+"px",transform:"translateY("+F+"px)",left:H.sidebar.offset().left+parseInt(H.sidebar.css("padding-left"))-T+"px",top:"0px"})}else{if("absolute"==K){var R={};"absolute"!=H.stickySidebar.css("position")&&(R.position="absolute",R.transform="translateY("+(z+F-H.sidebar.offset().top-H.stickySidebarPaddingTop-H.stickySidebarPaddingBottom)+"px)",R.top="0px"),R.width=m(H.stickySidebar)+"px",R.left="",H.stickySidebar.css(R)}else{"static"==K&&u()}}"static"!=K&&1==H.options.updateSidebarHeight&&H.sidebar.css({"min-height":H.stickySidebar.outerHeight()+H.stickySidebar.offset().top-H.sidebar.offset().top+H.paddingBottom}),H.previousScrollTop=z}}},r.onScroll(r),a(document).on("scroll."+r.options.namespace,(y=r,function(){y.onScroll(y)})),a(window).on("resize."+r.options.namespace,(w=r,function(){w.stickySidebar.css({position:"static"}),w.onScroll(w)})),"undefined"!=typeof ResizeSensor&&new ResizeSensor(r.stickySidebar[0],(p=r,function(){p.onScroll(p)}))})}(d,e),!0)}function m(d){var e;try{e=d[0].getBoundingClientRect().width}catch(d){}return void 0===e&&(e=d.width()),e}return(g=a.extend({containerSelector:"",additionalMarginTop:0,additionalMarginBottom:0,updateSidebarHeight:!0,minWidth:0,disableOnResponsiveLayouts:!0,sidebarBehavior:"modern",defaultPosition:"relative",namespace:"TSS"},g)).additionalMarginTop=parseInt(g.additionalMarginTop)||0,g.additionalMarginBottom=parseInt(g.additionalMarginBottom)||0,c(l=g,f=this)||(console.log("TSS: Body width smaller than options.minWidth. Init is delayed."),a(document).on("scroll."+l.namespace,(h=l,k=f,function(d){var e=c(h,k);e&&a(this).unbind(d)})),a(window).on("resize."+l.namespace,(j=l,b=f,function(d){var e=c(j,b);e&&a(this).unbind(d)}))),this}}(jQuery);